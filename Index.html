<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Love Teller</title>
<style>
  :root{
    --bg1:#ffdee9; --bg2:#b5fffc; --accent:#ff2d55; --ink:#1e1e2f;
  }

  /* dreamy animated background */
  body{
    margin:0; min-height:100svh; display:grid; place-items:center;
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    color:var(--ink);
    background:
      radial-gradient(1200px 600px at 70% -10%, #ffffff90, #ffffff00 70%),
      linear-gradient(130deg,var(--bg1),var(--bg2));
    background-size: 200% 200%;
    animation: bgShift 14s ease-in-out infinite;
  }
  @keyframes bgShift{
    0%{background-position:0% 50%}
    50%{background-position:100% 50%}
    100%{background-position:0% 50%}
  }

  .card{
    width:min(620px,92vw);
    padding:28px 26px;
    border-radius:28px;
    background:rgba(255,255,255,.78);
    backdrop-filter: blur(10px);
    box-shadow: 0 24px 80px rgba(0,0,0,.16);
    text-align:center;
  }
  h1{ margin:0 0 10px; font-size:clamp(26px,5vw,42px) }
  p{ margin:0 0 18px; opacity:.85 }

  .row{ display:flex; gap:12px; justify-content:center; align-items:center; flex-wrap:wrap }
  input[type="date"]{
    font-size:18px; padding:14px 16px; border-radius:14px; border:2px solid transparent;
    background:#fff; box-shadow: inset 0 1px 0 rgba(0,0,0,.04);
    outline:none; min-width: 230px;
  }
  input[type="date"]:focus{ border-color:#ffc0cb }
  button{
    padding:14px 18px; border:none; border-radius:14px; font-size:16px;
    background:var(--accent); color:#fff; cursor:pointer;
    transition: transform .05s ease;
  }
  button:active{ transform: translateY(1px) }

  /* shake when wrong */
  .shake{ animation: shake .35s linear }
  @keyframes shake{
    0%,100%{ transform:translateX(0) }
    20%{ transform:translateX(-6px) }
    40%{ transform:translateX(6px) }
    60%{ transform:translateX(-4px) }
    80%{ transform:translateX(4px) }
  }

  /* overlay love scene */
  .overlay{
    position:fixed; inset:0; display:none; place-items:center; z-index:10;
    background:
      radial-gradient(1000px 600px at 50% -10%, #ffffff80, #ffffff10 70%),
      linear-gradient(135deg,#fff0f6 0%, #ffe3ec 30%, #fff6e7 60%, #e7fff7 100%);
    animation: bgShift 14s ease-in-out infinite;
  }
  .overlay.show{ display:grid }
  .love-card{
    position:relative; overflow:hidden;
    width:min(800px,94vw); padding:40px 28px; border-radius:30px; text-align:center;
    background:rgba(255,255,255,.9); backdrop-filter: blur(12px);
    box-shadow: 0 30px 90px rgba(0,0,0,.22);
  }

  /* floating background hearts */
  .floaters{ position:absolute; inset:0; overflow:hidden; pointer-events:none }
  .floater{
    position:absolute; width:28px; height:28px; opacity:.85;
    animation: drift var(--t) linear infinite;
    transform: translateY(110vh) rotate(0deg);
    filter: drop-shadow(0 4px 6px rgba(0,0,0,.12));
  }
  @keyframes drift{
    0%{ transform: translateY(110vh) translateX(0) rotate(0) scale(.9); opacity:0 }
    10%{ opacity:.95 }
    100%{ transform: translateY(-120vh) translateX(var(--x)) rotate(60deg) scale(1.2); opacity:0 }
  }

  /* centerpiece pulsing heart */
  .big-heart{
    width:140px; height:140px; margin:6px auto 14px; display:block;
    animation: thump 1.2s ease-in-out infinite;
    filter: drop-shadow(0 10px 20px rgba(255,45,85,.35));
  }
  @keyframes thump{
    0%,100%{ transform: scale(1) }
    25%{ transform: scale(1.08) }
    50%{ transform: scale(1) }
    75%{ transform: scale(1.12) }
  }

  .type{
    display:inline-block; white-space:nowrap; border-right:2px solid var(--accent);
    font-size:clamp(22px,5vw,36px); padding:6px 2px; margin:10px 0 12px;
    animation: caret 1s steps(1) infinite;
  }
  @keyframes caret{ 50%{ border-color: transparent } }
  .sub{ font-size:clamp(14px,2.6vw,18px); opacity:.9 }

  .actions{ margin-top:18px; display:flex; gap:12px; justify-content:center; flex-wrap:wrap }
  .soft{ background:#fff; color:var(--accent); border:2px solid var(--accent) }

  /* canvases (no pointer capture) */
  canvas.particles, canvas.confetti{
    position:fixed; inset:0; pointer-events:none; z-index: 9;
  }
</style>
</head>
<body>
  <main class="card" id="card" aria-live="polite">
    <h1>ðŸ’Œ Love Teller</h1>
    <p>Select your birthday and see what destiny whispers.</p>

    <form id="form" autocomplete="off">
      <div class="row">
        <label class="sr" for="dob">Birthday</label>
        <input id="dob" type="date" />
        <button type="submit">Tell my love</button>
      </div>
    </form>
  </main>

  <!-- HEART PARTICLE + CONFETTI LAYERS -->
  <canvas class="particles" id="particles"></canvas>
  <canvas class="confetti" id="confetti"></canvas>

  <!-- LOVE OVERLAY -->
  <section class="overlay" id="overlay" aria-hidden="true">
    <div class="love-card">
      <div class="floaters" id="floaters"></div>

      <!-- Pulsing centerpiece heart (SVG) -->
      <svg class="big-heart" viewBox="0 0 100 90" aria-hidden="true">
        <path d="M50 82 L16 48 C2 34 2 13 20 6 c10-4 22 0 30 11 C58 6 70 2 80 6 c18 7 18 28 4 42 L50 82z"
              fill="url(#g)"/>
        <defs>
          <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0" stop-color="#ff4d6d"/>
            <stop offset="1" stop-color="#ff2d55"/>
          </linearGradient>
        </defs>
      </svg>

      <h2 class="type" id="type"></h2>
      <p class="sub">On <b>20/06/2005</b>, the stars learned your name. Today theyâ€™re spelling mine beside it. ðŸ’–</p>

      <div class="actions">
        <button class="soft" id="backBtn">Back</button>
        <button id="againBtn">Another line âœ¨</button>
      </div>
    </div>
  </section>

<script>
  // ===== Config =====
  const MAGIC_ISO = "2005-06-20"; // value from <input type="date">
  const LINES = [
    "I checked the starsâ€¦ and they spelled your name.",
    "You are loved. Today. Tomorrow. Always. ðŸ’—",
    "My favorite place is anywhere your smile exists.",
    "Your laugh is the shortcut to my heart.",
    "In a universe of maybes, youâ€™re my yes."
  ];

  // ===== Elements =====
  const form = document.getElementById('form');
  const dob = document.getElementById('dob');
  const card = document.getElementById('card');
  const overlay = document.getElementById('overlay');
  const typeEl = document.getElementById('type');
  const backBtn = document.getElementById('backBtn');
  const againBtn = document.getElementById('againBtn');

  // ===== Typewriter =====
  async function typeText(el, text, speed=32){
    el.textContent = "";
    for (let i=0;i<text.length;i++){
      el.textContent += text[i];
      await new Promise(r=>setTimeout(r, speed));
    }
  }

  // ===== Floating SVG Hearts (background) =====
  const floaters = document.getElementById('floaters');
  function svgHeart(color="#ff2d55"){
    const svg = document.createElementNS("http://www.w3.org/2000/svg","svg");
    svg.setAttribute("viewBox","0 0 100 90"); svg.classList.add("floater");
    svg.innerHTML = `<path d="M50 82 L16 48 C2 34 2 13 20 6 c10-4 22 0 30 11 C58 6 70 2 80 6 c18 7 18 28 4 42 L50 82z" fill="${color}" />`;
    return svg;
  }
  function spawnFloaters(){
    floaters.innerHTML = "";
    const count = 26;
    for (let i=0;i<count;i++){
      const h = svgHeart(`hsl(${330 + Math.random()*30}, 90%, ${55+Math.random()*10}%)`);
      const t = (10 + Math.random()*14).toFixed(2) + "s";
      const x = (Math.random()*120 - 60).toFixed(1) + "px"; // sideways drift
      h.style.setProperty('--t', t);
      h.style.setProperty('--x', x);
      h.style.left = Math.floor(Math.random()*100) + "%";
      h.style.bottom = "-40px";
      floaters.appendChild(h);
    }
  }

  // ===== Heart Burst Particles (canvas) =====
  const particleCanvas = document.getElementById('particles');
  const pc = particleCanvas.getContext('2d');
  const confettiCanvas = document.getElementById('confetti');
  const cc = confettiCanvas.getContext('2d');

  function resizeCanvases(){
    particleCanvas.width = innerWidth; particleCanvas.height = innerHeight;
    confettiCanvas.width = innerWidth; confettiCanvas.height = innerHeight;
  }
  addEventListener('resize', resizeCanvases); resizeCanvases();

  let particles = [];
  function heartPath(ctx, size=8){
    const s = size/15;
    ctx.moveTo(0, -5*s);
    ctx.bezierCurveTo( -12*s, -24*s, -40*s,  2*s,  0, 18*s);
    ctx.bezierCurveTo(  40*s,   2*s,  12*s, -24*s, 0, -5*s);
  }
  function burstHearts(x, y, count=60){
    for (let i=0;i<count;i++){
      const a = Math.random()*Math.PI*2;
      const sp = 2 + Math.random()*3.5;
      particles.push({
        x, y, vx: Math.cos(a)*sp, vy: Math.sin(a)*sp - 1.4,
        life: 70 + Math.random()*30,
        rot: Math.random()*Math.PI, vr: (Math.random()-.5)*0.3,
        size: 7 + Math.random()*8,
        hue: 330 + Math.random()*40
      });
    }
  }
  function stepParticles(){
    pc.clearRect(0,0,particleCanvas.width, particleCanvas.height);
    particles.forEach(p=>{
      p.life -= 1;
      p.x += p.vx; p.y += p.vy;
      p.vy += 0.05; // gravity
      p.rot += p.vr;

      pc.save();
      pc.translate(p.x, p.y);
      pc.rotate(p.rot);
      pc.fillStyle = `hsl(${p.hue}, 90%, 60%)`;
      pc.beginPath();
      heartPath(pc, p.size);
      pc.fill();
      pc.restore();
    });
    particles = particles.filter(p=>p.life>0);
    requestAnimationFrame(stepParticles);
  }
  stepParticles();

  // ===== Confetti (squares) =====
  let confettiPieces = [];
  function confettiBlast(x, y, n=160){
    confettiPieces = [];
    for(let i=0;i<n;i++){
      confettiPieces.push({
        x, y,
        vx: (Math.random()*4-2)* (1+Math.random()*1.3),
        vy: (Math.random()*-4-2)* (1+Math.random()*1.3),
        size: 3 + Math.random()*6,
        rot: Math.random()*Math.PI,
        vr: (Math.random()-.5)*0.25,
        life: 120 + Math.random()*80,
      });
    }
  }
  function stepConfetti(){
    cc.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);
    confettiPieces.forEach(p=>{
      p.life -= 1;
      p.x += p.vx; p.y += p.vy; p.vy += 0.06;
      p.rot += p.vr;
      cc.save(); cc.translate(p.x,p.y); cc.rotate(p.rot);
      cc.fillStyle = `hsl(${(p.x/innerWidth)*360}, 90%, 60%)`;
      cc.fillRect(-p.size/2,-p.size/2,p.size,p.size);
      cc.restore();
    });
    confettiPieces = confettiPieces.filter(p=>p.life>0);
    requestAnimationFrame(stepConfetti);
  }
  stepConfetti();

  // ===== Love Flow =====
  async function openLove(){
    overlay.classList.add('show');
    overlay.setAttribute('aria-hidden','false');
    spawnFloaters();
    // center of screen burst + confetti
    const cx = innerWidth/2, cy = innerHeight/2;
    burstHearts(cx, cy, 80);
    confettiBlast(cx, cy, 200);

    // type lines in sequence
    await typeText(typeEl, LINES[0], 30);
    setTimeout(()=>burstHearts(cx, cy, 50), 250);
  }

  function closeLove(){
    overlay.classList.remove('show');
    overlay.setAttribute('aria-hidden','true');
    typeEl.textContent = "";
  }

  againBtn.addEventListener('click', async ()=>{
    const msg = LINES[Math.floor(Math.random()*LINES.length)];
    await typeText(typeEl, msg, 26);
    burstHearts(innerWidth/2, innerHeight/2, 60);
    confettiBlast(innerWidth/2, innerHeight/2, 150);
  });

  backBtn.addEventListener('click', closeLove);

  // ===== Form =====
  form.addEventListener('submit', (e)=>{
    e.preventDefault();
    const value = dob.value; // yyyy-mm-dd from date input
    if(value === MAGIC_ISO){
      openLove();
    }else{
      card.classList.remove('shake'); void card.offsetWidth; card.classList.add('shake');
      // small side-burst for feedback
      burstHearts(card.getBoundingClientRect().left + card.offsetWidth/2, card.getBoundingClientRect().top + 30, 24);
    }
  });

  // Accessibility helper (screen-reader label without visual hint)
  const sr = document.createElement('style');
  sr.textContent = `.sr{position:absolute;left:-9999px;width:1px;height:1px;overflow:hidden}`;
  document.head.appendChild(sr);
</script>
</body>
</html>
